# CGatherLayer Class

<!-- TOC -->

- [Класс CGatherLayer](#класс-cgatherlayer)
    - [Настройки](#настройки)
    - [Обучаемые параметры](#обучаемые-параметры)
    - [Входы](#входы)
    - [Выходы](#выходы)

<!-- /TOC -->

Данный слой предназначен для выбора подпоследовательности элементов из данной по их индексам.
Это может быть полезно для различных NLP-задач. Например, извлечение последнего субтокена каждого слова (BPE-токенизированного) предложения.

Слой имеет поддержку padding'ов, что бывает полезно для последовательностей разной длины.
См. ниже раздел Настройки.

## Настройки

```c++
void EnablePaddings( bool enable );
```

Включение данной опции позволяет использовать padding-вектор - элемент с индексом `-1`.
Полезно для объединения последовательностей разной длины в один batch.
Padding-вектора заполнены нулями, а их градиент не перетекает в матрицу весов (`CGatherLayer::I_Weights`).

## Обучаемые параметры

Слой не содержит обучаемых параметров

## Входы

Слой имеет два входа.

Вход `CGatherLayer::I_Weights` содержит элементы исходной последовательности, запакованные во `float`-тензор следующей размерности:

- `BatchLength` - длина исходной последовательности
- `BatchWidth` - количество примеров в batch'е
- `ListSize` всегда равен `1`
- `Height`, `Width`, `Depth` и `Channels` могут быть любого размера.

Вход `CGatherLayer::I_Indexes` представляет собой `float`-тензор с индексами выбираемых элементов. Он имеет следующие размерности:

- `BatchLength` - длина выходной последовательности
- `BatchWidth` равен `BatchWidth` другого входа
- все остальные размерности равны `1`

Значения индексов могут лежать в диапазоне [0, `BatchLength` из входа `I_Weights`] (или [-1, `BatchLength` из входа `I_Weights`] если включены padding'и).

## Выходы

Единственный выход имеет следующие размерности:

- `BatchLength` равен `BatchLength` входа `I_Indexes`
- `BatchWidth` равен `BatchWidth` обоих входов
- `ListSize` равен `1`
- остальные размерности равны соответствующим размерностям входа `I_Weights`

Выходной блоб содержит вектора объектов `I_Weights`, выбранные согласно индексам из `I_Indexes`.
